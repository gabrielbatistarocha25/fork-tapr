### 
### ARQUIVO DE TESTE ATUALIZADO PARA API GATEWAY
###
### IMPORTANTE:
### 1. Instale a extensão "REST Client" no VS Code.
### 2. Na aba "Portas", encontre a porta 80 (nginx) e clique no ícone de "globo" (Abrir no Navegador).
### 3. Copie a URL que abriu no seu navegador (algo como https://seu-codespace-url-80.app.github.dev).
### 4. Cole essa URL na variável '@baseUrl' abaixo.
###

@baseUrl = http://localhost:80
@token = 

# ============================================
# 0. AUTH-SERVICE
#    - Registrar um usuário e obter um token JWT
# ============================================

### 0.1 Registrar novo usuário (opcional)
# @name auth-service
POST {{baseUrl}}/auth-service/users
Content-Type: application/json

{
    "name": "Gabriel",
    "email": "gabriel@teste.com",
    "password": "password123"
}

### 0.2 Obter Token de Autenticação
# @name login
POST {{baseUrl}}/auth-service/auth/login/password
Content-Type: application/json

{
    "email": "gabriel@teste.com",
    "password": "password123"
}

### 0.3 Salvar o token para os próximos requests
@token = {{login.response.body.accessToken}}


# ============================================
# 1. ORGANIZATION-SERVICE
#    - Criar entidades básicas: Location, Site, Rack
# ============================================

### 1.1 Criar Location 1
POST {{baseUrl}}/organization-service/api/organization/locations
Content-Type: application/json
Authorization: Bearer {{token}}

{
    "name": "Data Center Principal - Joinville",
    "address": "Rua das Máquinas, 123, Joinville"
}

### 1.2 Criar Location 2 (Opcional, para testar)
POST {{baseUrl}}/organization-service/api/organization/locations
Content-Type: application/json
Authorization: Bearer {{token}}

{
    "name": "Escritório Central - São Paulo",
    "address": "Av. Paulista, 1000, São Paulo"
}

### 1.3 Criar Site 1 (Associado à Location 1)
POST {{baseUrl}}/organization-service/api/organization/sites
Content-Type: application/json
Authorization: Bearer {{token}}

{
    "name": "JVE-MATRIZ-01",
    "location": {
        "id": 1
        // Assume que a primeira Location criada recebeu ID 1
    }
}

### 1.4 Criar Rack 1 (Associado ao Site 1)
POST {{baseUrl}}/organization-service/api/racks
Content-Type: application/json
Authorization: Bearer {{token}}

{
    "name": "RACK-A01",
    "uHeight": 42,
    "site": {
        "id": 1
        // Assume que o primeiro Site criado recebeu ID 1
    }
}

### 1.5 Consultar todas Locations (Verificar criação)
GET {{baseUrl}}/organization-service/api/organization/locations
Authorization: Bearer {{token}}

### 1.6 Consultar todos Sites (Verificar criação)
GET {{baseUrl}}/organization-service/api/organization/sites
Authorization: Bearer {{token}}

### 1.7 Consultar todos Racks (Verificar criação)
GET {{baseUrl}}/organization-service/api/racks
Authorization: Bearer {{token}}


# ============================================
# 2. INVENTORY-SERVICE
#    - Criar Manufacturer, DeviceModel e Device
# ============================================

### 2.1 Criar Fabricante 1
POST {{baseUrl}}/inventory-service/api/manufacturers
Content-Type: application/json
Authorization: Bearer {{token}}

{
    "name": "Cisco"
}

### 2.2 Criar Fabricante 2 (Opcional)
POST {{baseUrl}}/inventory-service/api/manufacturers
Content-Type: application/json
Authorization: Bearer {{token}}

{
    "name": "Juniper"
}


### 2.3 Criar Modelo de Dispositivo 1 (Associado ao Fabricante 1)
POST {{baseUrl}}/inventory-service/api/device-models
Content-Type: application/json
Authorization: Bearer {{token}}

{
    "name": "Catalyst 9300",
    "manufacturer": {
      "id": 1
      // Assume que o primeiro Fabricante recebeu ID 1
    }
}

### 2.4 Criar Dispositivo 1
#   -> Usa IDs criados nos passos 1.3 (Site) e 1.4 (Rack)
POST {{baseUrl}}/inventory-service/api/devices
Content-Type: application/json
Authorization: Bearer {{token}}

{
    "name": "SW-CORE-JVE-01",
    "position": 20,
    "siteId": 1,        // ID do Site criado no passo 1.3
    "rackId": 1,        // ID do Rack criado no passo 1.4
    "deviceModelId": 1  // ID do Modelo criado no passo 2.3
}

### 2.5 Consultar todos Fabricantes
GET {{baseUrl}}/inventory-service/api/manufacturers
Authorization: Bearer {{token}}

### 2.6 Consultar todos Modelos
GET {{baseUrl}}/inventory-service/api/device-models
Authorization: Bearer {{token}}

### 2.7 Consultar todos Dispositivos
GET {{baseUrl}}/inventory-service/api/devices
Authorization: Bearer {{token}}

### 2.8 Consultar Dispositivos do Site 1
GET {{baseUrl}}/inventory-service/api/sites/1/devices
Authorization: Bearer {{token}}


# ============================================
# 3. INFRASTRUCTURE-SERVICE
#    - Criar Vlan
# ============================================

### 3.1 Criar VLAN 1
#   -> Usa ID do Site criado no passo 1.3
POST {{baseUrl}}/infrastructure-service/api/vlans
Content-Type: application/json
Authorization: Bearer {{token}}

{
    "name": "VLAN-SERVIDORES-PROD-JVE",
    "vlanId": 10,
    "siteId": 1 // ID do Site criado no passo 1.3
}

### 3.2 Consultar todas VLANs
GET {{baseUrl}}/infrastructure-service/api/vlans
Authorization: Bearer {{token}}
